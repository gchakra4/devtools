<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DevTools Hub | Yogique</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <div class="container">
        <!-- Load centralized config -->
        <script src="/config.js"></script>
        <script>
            const cfg = window.DEVTOOLS_CONFIG || {};
            window.SUPABASE_URL = cfg.SUPABASE_URL || window.SUPABASE_URL;
            window.SUPABASE_ANON_KEY = cfg.SUPABASE_ANON_KEY || window.SUPABASE_ANON_KEY;
            window.REQUEST_ACCESS_URL = cfg.REQUEST_ACCESS_URL || window.REQUEST_ACCESS_URL;
            window.AUTH_START_URL = cfg.AUTH_START_URL || window.AUTH_START_URL;
            window.DEVTOOLS_HOME_URL = cfg.DEVTOOLS_HOME_URL || window.DEVTOOLS_HOME_URL;
        </script>
        <script type="module">
            (async () => {
                try {
                    const lib = await import('https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.4/+esm')
                    const createClient = lib.createClient
                    const supabase = createClient(window.SUPABASE_URL, window.SUPABASE_ANON_KEY)
                    window.supabaseClient = supabase

                    try {
                        const { data: sessionData } = await supabase.auth.getSession()
                        const uid = sessionData?.session?.user?.id
                        if (!uid) {
                            window.location.href = window.AUTH_START_URL
                            return
                        }
                        const { data, error } = await supabase
                            .from('devtools_developers')
                            .select('user_id')
                            .eq('user_id', uid)
                            .limit(1)
                        if (error) console.warn('Membership check failed', error)
                        if (!data || data.length === 0) window.location.href = window.REQUEST_ACCESS_URL
                    } catch (err) {
                        console.error('Supabase runtime error', err)
                        window.location.href = window.AUTH_START_URL
                    }
                } catch (e) {
                    console.error('Failed to import supabase module or init client', e)
                    // Show the auth start so user can still request a magic link
                    window.location.href = window.AUTH_START_URL
                }
            })()
        </script>
        <header class="header">
            <h1>üõ†Ô∏è DevTools Hub</h1>
            <p class="subtitle">Your collection of development tools and utilities</p>
        </header>

        <div class="tools-grid">
            <!-- Supabase Backup Tool -->
            <div class="tool-card">
                <div class="tool-icon">üóÑÔ∏è</div>
                <h3>Supabase Backup & Restore</h3>
                <p>Complete backup and restore solution for Supabase projects. Includes database, Edge Functions,
                    secrets, and storage.</p>
                <div class="tool-meta">
                    <span class="badge">Database</span>
                    <span class="badge">Migration</span>
                </div>
                <div class="tool-actions">
                    <a href="tools/supabase-backup/complete_guide/index.html" class="btn btn-primary">üìñ Open Guide</a>
                    <a href="https://github.com/gchakra4/devtools/tree/main/tools/supabase-backup"
                        class="btn btn-secondary" target="_blank">üîó GitHub</a>
                </div>
            </div>

            <!-- Git Workflow Guide -->
            <div class="tool-card">
                <div class="tool-icon"></div>
                <h3>Git Workflow Guide</h3>
                <p>Complete guide for managing multiple repositories, branches, and deployments. Learn how to work with
                    dev and production branches.</p>
                <div class="tool-meta">
                    <span class="badge">Git</span>
                    <span class="badge">Workflow</span>
                </div>
                <div class="tool-actions">
                    <a href="tools/git-workflow-guide/index.html" class="btn btn-primary"> Open Guide</a>
                    <a href="https://github.com/gchakra4/devtools/tree/main/tools/git-workflow-guide"
                        class="btn btn-secondary" target="_blank"> GitHub</a>
                </div>\n\n <!-- Auth Callback Tool -->\n <div class="tool-card">\n <div class="tool-icon"></div>\n <h3>
                        Auth Callback</h3>\n <p>Handles Supabase magic-link authentication and routes back to the
                        DevTools Hub.</p>\n <div class="tool-meta">\n <span class="badge">Auth</span>\n <span
                            class="badge">Supabase</span>\n </div>\n <div class="tool-actions">\n <a
                            href="tools/auth-callback/index.html" class="btn btn-primary"> Open</a>\n <a
                            href="https://github.com/gchakra4/devtools/tree/main/tools/auth-callback"
                            class="btn btn-secondary" target="_blank"> GitHub</a>\n </div>\n </div>\n\n
                <!-- Placeholder for future tools -->
                <div class="tool-card placeholder">
                    <div class="tool-icon">‚ûï</div>
                    <h3>Coming Soon</h3>
                    <p>More developer tools will be added here...</p>
                    <div class="tool-actions">
                        <button class="btn btn-disabled" disabled>Coming Soon</button>
                    </div>
                </div>

                <div class="tool-card placeholder">
                    <div class="tool-icon">üöÄ</div>
                    <h3>Your Next Tool</h3>
                    <p>Add your own development utilities and scripts here</p>
                    <div class="tool-actions">
                        <button class="btn btn-disabled" disabled>Coming Soon</button>
                    </div>
                </div>
            </div>

            <footer class="footer">
                <p>Built with ‚ù§Ô∏è for developers | <a href="https://yogique.life" target="_blank">Yogique</a></p>
            </footer>
        </div>

        <script src="js/main.js"></script>
</body>

</html>